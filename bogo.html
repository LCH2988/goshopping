<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¨‚è³¼æ¸…å–®æŸ¥è©¢ç³»çµ±</title>
  <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }
      
      body {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          background: linear-gradient(135deg, #00B900, #00D300);
          min-height: 100vh;
          padding: 20px;
      }
      
      .container {
          max-width: 400px;
          margin: 0 auto;
          background: white;
          border-radius: 20px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.2);
          overflow: hidden;
      }
      
      .header {
          background: linear-gradient(45deg, #00B900, #00D300);
          color: white;
          padding: 30px 20px;
          text-align: center;
      }
      
      .header h1 {
          font-size: 24px;
          margin-bottom: 10px;
      }
      
      .content {
          padding: 30px 20px;
      }
      
      .tab-buttons {
          display: flex;
          margin-bottom: 30px;
          border-radius: 10px;
          overflow: hidden;
          background: #f5f5f5;
      }
      
      .tab-button {
          flex: 1;
          padding: 15px;
          text-align: center;
          background: #f5f5f5;
          border: none;
          cursor: pointer;
          font-size: 14px;
          transition: all 0.3s;
      }
      
      .tab-button.active {
          background: #00B900;
          color: white;
      }
      
      .tab-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
      }
      
      .tab-content {
          display: none;
      }
      
      .tab-content.active {
          display: block;
      }
      
      .form-group {
          margin-bottom: 20px;
      }
      
      .form-group label {
          display: block;
          margin-bottom: 8px;
          font-weight: 600;
          color: #333;
      }
      
      .form-group input, .form-group select {
          width: 100%;
          padding: 15px;
          border: 2px solid #e0e0e0;
          border-radius: 10px;
          font-size: 16px;
          transition: border-color 0.3s;
      }
      
      .form-group input:focus, .form-group select:focus {
          outline: none;
          border-color: #00B900;
      }
      
      .btn {
          width: 100%;
          padding: 15px;
          background: linear-gradient(45deg, #00B900, #00D300);
          color: white;
          border: none;
          border-radius: 10px;
          font-size: 16px;
          font-weight: 600;
          cursor: pointer;
          transition: transform 0.2s;
      }
      
      .btn:hover {
          transform: translateY(-2px);
      }
      
      .btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
          transform: none;
      }
      
      .order-item {
          background: #f8f9fa;
          padding: 20px;
          margin-bottom: 15px;
          border-radius: 10px;
          border-left: 4px solid #00B900;
      }
      
      .order-item h3 {
          color: #00B900;
          margin-bottom: 10px;
      }
      
      .order-detail {
          display: flex;
          justify-content: space-between;
          margin-bottom: 5px;
          font-size: 14px;
      }
      
      .total-amount {
          font-size: 18px;
          font-weight: bold;
          color: #e74c3c;
          text-align: right;
          margin-top: 10px;
      }
      
      .status-badge {
          display: inline-block;
          padding: 5px 12px;
          border-radius: 20px;
          font-size: 12px;
          font-weight: 600;
      }
      
      .status-pending {
          background: #fff3cd;
          color: #856404;
      }
      
      .status-paid {
          background: #d4edda;
          color: #155724;
      }
      
      .upload-area {
          border: 2px dashed #00B900;
          border-radius: 10px;
          padding: 30px;
          text-align: center;
          margin-bottom: 20px;
          cursor: pointer;
          transition: background-color 0.3s;
      }
      
      .upload-area:hover {
          background-color: #f8f9fa;
      }
      
      .upload-icon {
          font-size: 48px;
          color: #00B900;
          margin-bottom: 10px;
      }
      
      .user-info {
          background: #e8f5e8;
          padding: 15px;
          border-radius: 10px;
          margin-bottom: 20px;
          text-align: center;
      }
      
      .user-info h3 {
          color: #00B900;
          margin-bottom: 10px;
      }
      
      .loading {
          text-align: center;
          padding: 40px;
          color: #666;
      }
      
      .error {
          background: #f8d7da;
          color: #721c24;
          padding: 15px;
          border-radius: 10px;
          margin-bottom: 20px;
      }
      
      .success {
          background: #d4edda;
          color: #155724;
          padding: 15px;
          border-radius: 10px;
          margin-bottom: 20px;
      }
      
      .welcome-message {
          background: #e8f5e8;
          padding: 20px;
          border-radius: 10px;
          text-align: center;
          margin-bottom: 20px;
      }
      
      .welcome-message h3 {
          color: #00B900;
          margin-bottom: 10px;
      }
      
      .registered-info {
          background: #d4edda;
          padding: 20px;
          border-radius: 10px;
          text-align: center;
          margin-bottom: 20px;
      }
      
      .registered-info h3 {
          color: #155724;
          margin-bottom: 10px;
      }
      
      .lock-message {
          text-align: center;
          padding: 40px;
          color: #666;
          background: #f8f9fa;
          border-radius: 10px;
          margin: 20px 0;
      }
      
      .lock-icon {
          font-size: 48px;
          margin-bottom: 15px;
      }

      .btn-group {
          display: flex;
          gap: 10px;
      }

      .btn-group .btn {
          flex: 1;
      }

      .btn.secondary {
          background: linear-gradient(45deg, #e74c3c, #c0392b);
      }
  </style>
</head>
<body>
  <div class="container">
      <div class="header">
          <h1>ğŸ›’ è¨‚è³¼ç®¡ç†ç³»çµ±</h1>
          <p>å¯¦ååˆ¶ç™»è¨˜ Â· è¨‚å–®æŸ¥è©¢ Â· ç¹³è²»å›å ±</p>
      </div>
      
      <div class="content">
          <!-- ç”¨æˆ¶è³‡è¨Šé¡¯ç¤º -->
          <div id="userInfo" class="user-info" style="display: none;">
              <h3>ğŸ‘¤ æœƒå“¡è³‡è¨Š</h3>
              <p><strong>LINE åç¨±:</strong> <span id="lineDisplayName"></span></p>
              <p><strong>çœŸå¯¦å§“å:</strong> <span id="realName"></span></p>
              <p><strong>è¨»å†Šæ™‚é–“:</strong> <span id="registerTime"></span></p>
          </div>
          
          <!-- æ¨™ç±¤é æŒ‰éˆ• -->
          <div class="tab-buttons">
              <button class="tab-button active" onclick="switchTab('register')">å¯¦åç™»è¨˜</button>
              <button class="tab-button" id="ordersTab" onclick="switchTab('orders')" disabled>æˆ‘çš„è¨‚å–®</button>
              <button class="tab-button" id="paymentTab" onclick="switchTab('payment')" disabled>ç¹³è²»å›å ±</button>
          </div>
          
          <!-- å¯¦ååˆ¶ç™»è¨˜ -->
          <div id="register" class="tab-content active">
              <!-- æœªè¨»å†Šç‹€æ…‹ -->
              <div id="registerForm" style="display: none;">
                  <div class="welcome-message">
                      <h3>ğŸ‘‹ æ­¡è¿ä½¿ç”¨è¨‚è³¼ç³»çµ±</h3>
                      <p>è«‹å…ˆå®Œæˆå¯¦ååˆ¶ç™»è¨˜ï¼Œå³å¯æŸ¥è©¢è¨‚å–®åŠé€²è¡Œç¹³è²»å›å ±</p>
                  </div>
                  
                  <h2>ğŸ“ å¯¦ååˆ¶ç™»è¨˜</h2>
                  <form id="nameForm">
                      <div class="form-group">
                          <label for="realNameInput">çœŸå¯¦å§“å *</label>
                          <input type="text" id="realNameInput" name="realName" required placeholder="è«‹è¼¸å…¥æ‚¨çš„çœŸå¯¦å§“å">
                      </div>
                      
                      <button type="submit" class="btn">å®Œæˆç™»è¨˜</button>
                  </form>
              </div>
              
              <!-- å·²è¨»å†Šç‹€æ…‹ -->
              <div id="registeredStatus" style="display: none;">
                  <div class="registered-info">
                      <h3>âœ… å¯¦ååˆ¶ç™»è¨˜å®Œæˆ</h3>
                      <p>æ‚¨å·²å®Œæˆå¯¦ååˆ¶ç™»è¨˜ï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½</p>
                  </div>
                  
                  <div class="btn-group">
                      <button class="btn" onclick="switchTab('orders')">æŸ¥çœ‹æˆ‘çš„è¨‚å–®</button>
                      <button class="btn secondary" onclick="switchTab('payment')">é€²è¡Œç¹³è²»å›å ±</button>
                  </div>
              </div>
          </div>
          
          <!-- è¨‚å–®æŸ¥è©¢ -->
          <div id="orders" class="tab-content">
              <div id="ordersContent">
                  <div class="lock-message">
                      <div class="lock-icon">ğŸ”’</div>
                      <h3>è«‹å…ˆå®Œæˆå¯¦ååˆ¶ç™»è¨˜</h3>
                      <p>å®Œæˆç™»è¨˜å¾Œå³å¯æŸ¥è©¢æ‚¨çš„è¨‚å–®è³‡è¨Š</p>
                  </div>
              </div>
          </div>
          
          <!-- ç¹³è²»å›å ± -->
          <div id="payment" class="tab-content">
              <div id="paymentContent">
                  <div class="lock-message">
                      <div class="lock-icon">ğŸ”’</div>
                      <h3>è«‹å…ˆå®Œæˆå¯¦ååˆ¶ç™»è¨˜</h3>
                      <p>å®Œæˆç™»è¨˜å¾Œå³å¯é€²è¡Œç¹³è²»å›å ±</p>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <script>
      // è¨­å®šå€åŸŸ - è«‹ä¿®æ”¹ç‚ºæ‚¨çš„å¯¦éš›å€¼
      const CONFIG = {
          LIFF_ID: '1657285806-2bmkYWkN', // è«‹æ›¿æ›ç‚ºå¯¦éš›çš„ LIFF ID
          API_BASE_URL: 'https://script.google.com/macros/s/AKfycbwqT2H7ouYyP1KVF-57KUHOV6qsThJovkfV161qgPtFWUra01KOgPJEz8mgXPIbcUNS/exec' // è«‹æ›¿æ›ç‚º GAS éƒ¨ç½²ç¶²å€
      };

      let userId = null;
      let userProfile = null;
      let isRegistered = false;
      let userRegistrationData = null;

      // åˆå§‹åŒ– LIFF
      window.onload = function() {
          initializeLiff();
      };

      async function initializeLiff() {
          try {
              await liff.init({ liffId: CONFIG.LIFF_ID });
              
              if (liff.isLoggedIn()) {
                  userProfile = await liff.getProfile();
                  userId = userProfile.userId;
                  
                  // æª¢æŸ¥ç”¨æˆ¶æ˜¯å¦å·²è¨»å†Š
                  await checkUserRegistration();
              } else {
                  liff.login();
              }
          } catch (error) {
              console.error('LIFFåˆå§‹åŒ–å¤±æ•—:', error);
              showError('ç³»çµ±åˆå§‹åŒ–å¤±æ•—ï¼Œè«‹é‡æ–°é–‹å•Ÿ');
          }
      }

      async function checkUserRegistration() {
          try {
              const response = await fetch(`${CONFIG.API_BASE_URL}?path=check-registration`, {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/json',
                  },
                  body: JSON.stringify({ 
                      userId: userId,
                      lineDisplayName: userProfile.displayName 
                  })
              });
              
              const data = await response.json();
              
              if (data.registered) {
                  isRegistered = true;
                  userRegistrationData = data.userInfo;
                  showRegisteredStatus();
                  enableAllTabs();
              } else {
                  showRegisterForm();
              }
          } catch (error) {
              console.error('æª¢æŸ¥è¨»å†Šç‹€æ…‹å¤±æ•—:', error);
              showRegisterForm(); // ç™¼ç”ŸéŒ¯èª¤æ™‚é¡¯ç¤ºè¨»å†Šè¡¨å–®
          }
      }

      function showRegisterForm() {
          document.getElementById('registerForm').style.display = 'block';
          document.getElementById('registeredStatus').style.display = 'none';
      }

      function showRegisteredStatus() {
          document.getElementById('registerForm').style.display = 'none';
          document.getElementById('registeredStatus').style.display = 'block';
          
          // é¡¯ç¤ºç”¨æˆ¶è³‡è¨Š
          document.getElementById('lineDisplayName').textContent = userProfile.displayName;
          document.getElementById('realName').textContent = userRegistrationData.realName;
          document.getElementById('registerTime').textContent = new Date(userRegistrationData.registeredAt).toLocaleDateString('zh-TW');
          document.getElementById('userInfo').style.display = 'block';
      }

      function enableAllTabs() {
          document.getElementById('ordersTab').disabled = false;
          document.getElementById('paymentTab').disabled = false;
          
          // æ›´æ–°è¨‚å–®å’Œç¹³è²»é é¢å…§å®¹
          updateOrdersContent();
          updatePaymentContent();
      }

      function updateOrdersContent() {
          document.getElementById('ordersContent').innerHTML = `
              <h2>ğŸ“‹ æˆ‘çš„è¨‚å–®</h2>
              <div id="ordersList">
                  <div class="loading">è¼‰å…¥ä¸­...</div>
              </div>
              <button class="btn" onclick="loadOrders()">é‡æ–°è¼‰å…¥</button>
          `;
          loadOrders();
      }

      function updatePaymentContent() {
          document.getElementById('paymentContent').innerHTML = `
              <h2>ğŸ’³ ç¹³è²»å›å ±</h2>
              
              <div class="form-group">
                  <label for="orderSelect">é¸æ“‡è¨‚å–®</label>
                  <select id="orderSelect">
                      <option value="">è«‹é¸æ“‡è¦ç¹³è²»çš„è¨‚å–®</option>
                  </select>
              </div>
              
              <div class="form-group">
                  <label>ä¸Šå‚³ç¹³è²»è­‰æ˜</label>
                  <div class="upload-area" onclick="document.getElementById('paymentProof').click()">
                      <div class="upload-icon">ğŸ“·</div>
                      <p>é»æ“Šä¸Šå‚³ç¹³è²»è­‰æ˜ç…§ç‰‡</p>
                      <small>æ”¯æ´ JPG, PNG æ ¼å¼</small>
                  </div>
                  <input type="file" id="paymentProof" accept="image/*" style="display: none;" onchange="handleFileUpload(this)">
              </div>
              
              <div class="form-group">
                  <label for="paymentMethod">ç¹³è²»æ–¹å¼</label>
                  <select id="paymentMethod">
                      <option value="bank_transfer">éŠ€è¡Œè½‰å¸³</option>
                      <option value="cash">ç¾é‡‘</option>
                      <option value="line_pay">LINE Pay</option>
                      <option value="credit_card">ä¿¡ç”¨å¡</option>
                  </select>
              </div>
              
              <div class="form-group">
                  <label for="paymentNote">å‚™è¨»</label>
                  <input type="text" id="paymentNote" placeholder="è½‰å¸³å¸³è™Ÿå¾Œ5ç¢¼æˆ–å…¶ä»–èªªæ˜">
              </div>
              
              <button class="btn" onclick="submitPayment()">æäº¤ç¹³è²»è­‰æ˜</button>
          `;
          loadOrdersForPayment();
      }

      // æ¨™ç±¤é åˆ‡æ›
      function switchTab(tabName) {
          // æª¢æŸ¥æ˜¯å¦å·²è¨»å†Šï¼ˆé™¤äº†registeré é¢ï¼‰
          if (tabName !== 'register' && !isRegistered) {
              showError('è«‹å…ˆå®Œæˆå¯¦ååˆ¶ç™»è¨˜');
              return;
          }
          
          // ç§»é™¤æ‰€æœ‰active class
          document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
          
          // æ·»åŠ active class
          event.target.classList.add('active');
          document.getElementById(tabName).classList.add('active');
          
          // è¼‰å…¥å°æ‡‰å…§å®¹
          if (tabName === 'orders' && isRegistered) {
              loadOrders();
          } else if (tabName === 'payment' && isRegistered) {
              loadOrdersForPayment();
          }
      }

      // å¯¦ååˆ¶ç™»è¨˜
      document.addEventListener('submit', async function(e) {
          if (e.target.id === 'nameForm') {
              e.preventDefault();
              
              const formData = new FormData(e.target);
              const realName = formData.get('realName').trim();
              
              if (!realName) {
                  showError('è«‹è¼¸å…¥çœŸå¯¦å§“å');
                  return;
              }
              
              const registerData = {
                  userId: userId,
                  lineDisplayName: userProfile.displayName,
                  realName: realName,
                  registeredAt: new Date().toISOString()
              };
              
              try {
                  // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
                  const submitBtn = e.target.querySelector('button[type="submit"]');
                  const originalText = submitBtn.textContent;
                  submitBtn.textContent = 'ç™»è¨˜ä¸­...';
                  submitBtn.disabled = true;
                  
                  const response = await fetch(`${CONFIG.API_BASE_URL}?path=register`, {
                      method: 'POST',
                      headers: {
                          'Content-Type': 'application/json',
                      },
                      body: JSON.stringify(registerData)
                  });
                  
                  const result = await response.json();
                  
                  if (result.success) {
                      showSuccess('å¯¦ååˆ¶ç™»è¨˜å®Œæˆï¼');
                      isRegistered = true;
                      userRegistrationData = registerData;
                      showRegisteredStatus();
                      enableAllTabs();
                  } else {
                      showError(result.message || 'ç™»è¨˜å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
                      submitBtn.textContent = originalText;
                      submitBtn.disabled = false;
                  }
              } catch (error) {
                  console.error('ç™»è¨˜å¤±æ•—:', error);
                  showError('ç™»è¨˜å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
                  submitBtn.textContent = originalText;
                  submitBtn.disabled = false;
              }
          }
      });

      // è¼‰å…¥è¨‚å–®
      async function loadOrders() {
          if (!isRegistered) return;
          
          document.getElementById('ordersList').innerHTML = '<div class="loading">è¼‰å…¥ä¸­...</div>';
          
          try {
              const response = await fetch(`${CONFIG.API_BASE_URL}?path=orders`, {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/json',
                  },
                  body: JSON.stringify({ userId: userId })
              });
              
              const data = await response.json();
              
              if (data.success && data.orders.length > 0) {
                  displayOrders(data.orders);
              } else {
                  document.getElementById('ordersList').innerHTML = '<div class="error">æš«ç„¡è¨‚å–®è¨˜éŒ„</div>';
              }
          } catch (error) {
              console.error('è¼‰å…¥è¨‚å–®å¤±æ•—:', error);
              document.getElementById('ordersList').innerHTML = '<div class="error">è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦</div>';
          }
      }

      function displayOrders(orders) {
          let html = '';
          let totalAmount = 0;
          
          orders.forEach(order => {
              const statusClass = order.paymentStatus === 'å·²ä»˜æ¬¾' ? 'status-paid' : 'status-pending';
              const statusText = order.paymentStatus === 'å·²ä»˜æ¬¾' ? 'å·²ä»˜æ¬¾' : 'å¾…ä»˜æ¬¾';
              
              html += `
                  <div class="order-item">
                      <h3>è¨‚å–® #${order.orderId}</h3>
                      <div class="order-detail">
                          <span>ç”¢å“åç¨±:</span>
                          <span>${order.productName}</span>
                      </div>
                      <div class="order-detail">
                          <span>å–®åƒ¹:</span>
                          <span>NT$ ${order.unitPrice.toLocaleString()}</span>
                      </div>
                      <div class="order-detail">
                          <span>æ•¸é‡:</span>
                          <span>${order.quantity}</span>
                      </div>
                      <div class="order-detail">
                          <span>ä»˜æ¬¾ç‹€æ…‹:</span>
                          <span class="status-badge ${statusClass}">${statusText}</span>
                      </div>
                      <div class="total-amount">
                          å°è¨ˆ: NT$ ${order.totalAmount.toLocaleString()}
                      </div>
                  </div>
              `;
              totalAmount += order.totalAmount;
          });
          
          html += `
              <div class="order-item" style="background: #e8f5e8; border-left-color: #00B900;">
                  <div class="total-amount" style="font-size: 20px; color: #00B900;">
                      ç¸½é‡‘é¡: NT$ ${totalAmount.toLocaleString()}
                  </div>
              </div>
          `;
          
          document.getElementById('ordersList').innerHTML = html;
      }

      // è¼‰å…¥è¨‚å–®ä¾›ç¹³è²»é¸æ“‡
      async function loadOrdersForPayment() {
          if (!isRegistered) return;
          
          try {
              const response = await fetch(`${CONFIG.API_BASE_URL}?path=orders`, {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/json',
                  },
                  body: JSON.stringify({ userId: userId })
              });
              
              const data = await response.json();
              const select = document.getElementById('orderSelect');
              if (select) {
                  select.innerHTML = '<option value="">è«‹é¸æ“‡è¦ç¹³è²»çš„è¨‚å–®</option>';
                  
                  if (data.success && data.orders.length > 0) {
                      data.orders.forEach(order => {
                          if (order.paymentStatus !== 'å·²ä»˜æ¬¾') {
                              select.innerHTML += `
                                  <option value="${order.orderId}">
                                      è¨‚å–® #${order.orderId} - ${order.productName} (NT$ ${order.totalAmount.toLocaleString()})
                                  </option>
                              `;
                          }
                      });
                  }
              }
          } catch (error) {
              console.error('è¼‰å…¥è¨‚å–®å¤±æ•—:', error);
          }
      }

      // è™•ç†æª”æ¡ˆä¸Šå‚³
      function handleFileUpload(input) {
          const file = input.files[0];
          if (file) {
              const uploadArea = input.parentElement;
              uploadArea.innerHTML = `
                  <div class="upload-icon">âœ…</div>
                  <p>å·²é¸æ“‡: ${file.name}</p>
                  <small>é»æ“Šé‡æ–°é¸æ“‡</small>
              `;
          }
      }

      // æäº¤ç¹³è²»è­‰æ˜
      async function submitPayment() {
          const orderId = document.getElementById('orderSelect').value;
          const paymentProof = document.getElementById('paymentProof').files[0];
          const paymentMethod = document.getElementById('paymentMethod').value;
          const paymentNote = document.getElementById('paymentNote').value;
          
          if (!orderId) {
              showError('è«‹é¸æ“‡è¦ç¹³è²»çš„è¨‚å–®');
              return;
          }
          
          if (!paymentProof) {
              showError('è«‹ä¸Šå‚³ç¹³è²»è­‰æ˜');
              return;
          }
          
          const formData = new FormData();
          formData.append('userId', userId);
          formData.append('orderId', orderId);
          formData.append('paymentProof', paymentProof);
          formData.append('paymentMethod', paymentMethod);
          formData.append('paymentNote', paymentNote);
          formData.append('realName', userRegistrationData.realName);
          
          try {
              const response = await fetch(`${CONFIG.API_BASE_URL}?path=submit-payment`, {
                  method: 'POST',
                  body: formData
              });
              
              const result = await response.json();
              
              if (result.success) {
                  showSuccess('ç¹³è²»è­‰æ˜æäº¤æˆåŠŸï¼æˆ‘å€‘æœƒç›¡å¿«è™•ç†æ‚¨çš„ä»˜æ¬¾');
                  // æ¸…ç©ºè¡¨å–®
                  document.getElementById('orderSelect').value = '';
                  document.getElementById('paymentProof').value = '';
                  document.getElementById('paymentNote').value = '';
                  // é‡ç½®ä¸Šå‚³å€åŸŸ
                  document.querySelector('.upload-area').innerHTML = `
                      <div class="upload-icon">ğŸ“·</div>
                      <p>é»æ“Šä¸Šå‚³ç¹³è²»è­‰æ˜ç…§ç‰‡</p>
                      <small>æ”¯æ´ JPG, PNG æ ¼å¼</small>
                  `;
                  // é‡æ–°è¼‰å…¥è¨‚å–®
                  loadOrders();
              } else {
                  showError(result.message || 'æäº¤å¤±æ•—');
              }
          } catch (error) {
              console.error('æäº¤å¤±æ•—:', error);
              showError('æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
          }
      }

      // é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
      function showError(message) {
          const errorDiv = document.createElement('div');
          errorDiv.className = 'error';
          errorDiv.textContent = message;
          
          const content = document.querySelector('.content');
          content.insertBefore(errorDiv, content.firstChild);
          
          setTimeout(() => {
              errorDiv.remove();
          }, 5000);
      }

      // é¡¯ç¤ºæˆåŠŸè¨Šæ¯
      function showSuccess(message) {
          const successDiv = document.createElement('div');
          successDiv.className = 'success';
          successDiv.textContent = message;
          
          const content = document.querySelector('.content');
          content.insertBefore(successDiv, content.firstChild);
          
          setTimeout(() => {
              successDiv.remove();
          }, 5000);
      }
  </script>
</body>
</html>
